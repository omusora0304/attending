import{t as x,s as w,b as T,e as ue,h as Ft}from"../chunks/CKQCreVm.js";import{i as vt}from"../chunks/Bm3K0hjP.js";import{y as dt,r as ce,z as mt,aV as Ve,j as r,aW as ut,C as c,F as o,E as v,B as V,G as pt,v as Y,D as ft,d as _e,A as Ot,$ as Lt}from"../chunks/BVNNn7ox.js";import{i as re,s as Vt,a as Yt}from"../chunks/BqwgYQ-J.js";import{e as he,i as ye,a as At,c as Wt,s as qt}from"../chunks/BPY4y56w.js";import{b as ht}from"../chunks/DvOeuFBO.js";import{G as Ht,i as Bt,s as Gt}from"../chunks/Ddin1ii5.js";import{p as Re}from"../chunks/DUUr3DC5.js";import{b as Jt}from"../chunks/C0v4optL.js";import{t as P,c as be,m as Ae,a as yt,s as Zt,f as G,j as Ye}from"../chunks/DRTtKfAx.js";/* empty css                */function lt(a,e,s){const t=P(a,s==null?void 0:s.in);return isNaN(e)?be(a,NaN):(t.setDate(t.getDate()+e),t)}function Qt(a,e,s){const t=P(a,s==null?void 0:s.in);if(isNaN(e))return be(a,NaN);if(!e)return t;const n=t.getDate(),i=be(a,t.getTime());i.setMonth(t.getMonth()+e+1,0);const m=i.getDate();return n>=m?i:(t.setFullYear(i.getFullYear(),i.getMonth(),n),t)}function _t(a,e){const s=P(a,e==null?void 0:e.in).getDay();return s===0||s===6}function Xt(a){return e=>{const t=(a?Math[a]:Math.trunc)(e);return t===0?0:t}}function Kt(a,e){return+P(a)-+P(e)}function Fe(a,e,s){const t=Kt(a,e)/Ae;return Xt(s==null?void 0:s.roundingMethod)(t)}function ea(a,e){const s=P(a,e==null?void 0:e.in);return s.setHours(23,59,59,999),s}function ta(a,e){const s=P(a,e==null?void 0:e.in),t=s.getMonth();return s.setFullYear(s.getFullYear(),t+1,0),s.setHours(23,59,59,999),s}function aa(a,e){const s=P(a,e==null?void 0:e.in);return s.setDate(1),s.setHours(0,0,0,0),s}function sa(a,e){return+P(a)<+P(e)}function Oe(a,e){const s=()=>be(e==null?void 0:e.in,NaN),n=la(a);let i;if(n.date){const y=ca(n.date,2);i=ia(y.restDateString,y.year)}if(!i||isNaN(+i))return s();const m=+i;let l=0,k;if(n.time&&(l=va(n.time),isNaN(l)))return s();if(n.timezone){if(k=da(n.timezone),isNaN(k))return s()}else{const y=new Date(m+l),_=P(0,e==null?void 0:e.in);return _.setFullYear(y.getUTCFullYear(),y.getUTCMonth(),y.getUTCDate()),_.setHours(y.getUTCHours(),y.getUTCMinutes(),y.getUTCSeconds(),y.getUTCMilliseconds()),_}return P(m+l+k,e==null?void 0:e.in)}const ge={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ra=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,na=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,oa=/^([+-])(\d{2})(?::?(\d{2}))?$/;function la(a){const e={},s=a.split(ge.dateTimeDelimiter);let t;if(s.length>2)return e;if(/:/.test(s[0])?t=s[0]:(e.date=s[0],t=s[1],ge.timeZoneDelimiter.test(e.date)&&(e.date=a.split(ge.timeZoneDelimiter)[0],t=a.substr(e.date.length,a.length))),t){const n=ge.timezone.exec(t);n?(e.time=t.replace(n[1],""),e.timezone=n[1]):e.time=t}return e}function ca(a,e){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),t=a.match(s);if(!t)return{year:NaN,restDateString:""};const n=t[1]?parseInt(t[1]):null,i=t[2]?parseInt(t[2]):null;return{year:i===null?n:i*100,restDateString:a.slice((t[1]||t[2]).length)}}function ia(a,e){if(e===null)return new Date(NaN);const s=a.match(ra);if(!s)return new Date(NaN);const t=!!s[4],n=pe(s[1]),i=pe(s[2])-1,m=pe(s[3]),l=pe(s[4]),k=pe(s[5])-1;if(t)return ha(e,l,k)?ma(e,l,k):new Date(NaN);{const y=new Date(0);return!pa(e,i,m)||!fa(e,n)?new Date(NaN):(y.setUTCFullYear(e,i,Math.max(n,m)),y)}}function pe(a){return a?parseInt(a):1}function va(a){const e=a.match(na);if(!e)return NaN;const s=Le(e[1]),t=Le(e[2]),n=Le(e[3]);return ya(s,t,n)?s*yt+t*Ae+n*1e3:NaN}function Le(a){return a&&parseFloat(a.replace(",","."))||0}function da(a){if(a==="Z")return 0;const e=a.match(oa);if(!e)return 0;const s=e[1]==="+"?-1:1,t=parseInt(e[2]),n=e[3]&&parseInt(e[3])||0;return _a(t,n)?s*(t*yt+n*Ae):NaN}function ma(a,e,s){const t=new Date(0);t.setUTCFullYear(a,0,4);const n=t.getUTCDay()||7,i=(e-1)*7+s+1-n;return t.setUTCDate(t.getUTCDate()+i),t}const ua=[31,null,31,30,31,30,31,31,30,31,30,31];function gt(a){return a%400===0||a%4===0&&a%100!==0}function pa(a,e,s){return e>=0&&e<=11&&s>=1&&s<=(ua[e]||(gt(a)?29:28))}function fa(a,e){return e>=1&&e<=(gt(a)?366:365)}function ha(a,e,s){return e>=1&&e<=53&&s>=0&&s<=6}function ya(a,e,s){return a===24?e===0&&s===0:s>=0&&s<60&&e>=0&&e<60&&a>=0&&a<25}function _a(a,e){return e>=0&&e<=59}function ga(a,e,s){return Qt(a,-e,s)}const R=a=>G(a,"yyyy-MM-dd"),ct=a=>G(a,"yyyy-'W'ww",{locale:Ye}),it=a=>G(a,"yyyy-MM"),ba=(a,e)=>{const s=new Map;if(R(a)===R(e)){const m=Fe(e,a);return s.set(R(a),m),s}let t=new Date(a);const n=ea(t),i=Fe(n,a);for(s.set(R(t),i),t=lt(t,1);R(t)!==R(e);)s.set(R(t),1440),t=lt(t,1);if(R(t)===R(e)){const m=Zt(e),l=Fe(e,m);s.set(R(t),l)}return s},wa=(a,e,s)=>{const t=new Map,n=[],i=[];a.forEach(d=>{d.type==="in"?n.push(d):d.type==="out"&&i.push(d)}),i.forEach(d=>{if(!d.duration)return;const h=n.filter(p=>sa(p.timestamp,d.timestamp)).sort((p,D)=>D.timestamp.getTime()-p.timestamp.getTime())[0];if(h)ba(h.timestamp,d.timestamp).forEach((D,M)=>{t.set(M,(t.get(M)||0)+D)});else{const p=R(d.timestamp);t.set(p,(t.get(p)||0)+(d.duration||0))}});const m=new Map,l=new Map,k=new Map,y=new Map,_=new Map;t.forEach((d,h)=>{try{const p=Oe(h),D=ct(p),M=it(p);m.has(h)||m.set(h,[]),l.has(D)||l.set(D,[]),k.has(M)||k.set(M,[]),_t(p)?_.set(h,d):y.set(h,d)}catch(p){console.error(`Invalid date key: ${h}`,p)}});const J=new Map;t.forEach((d,h)=>{J.set(h,{totalTime:d,averageTime:d,daysPresent:1})});const Z=new Map,ee=new Map,A=new Map;t.forEach((d,h)=>{var p;try{const D=Oe(h),M=ct(D);ee.set(M,(ee.get(M)||0)+d),A.has(M)||A.set(M,new Set),(p=A.get(M))==null||p.add(h)}catch(D){console.error(`Error processing date: ${h}`,D)}}),ee.forEach((d,h)=>{var D;const p=((D=A.get(h))==null?void 0:D.size)||0;Z.set(h,{totalTime:d,averageTime:p>0?d/p:0,daysPresent:p})});const ne=new Map,te=new Map,g=new Map;t.forEach((d,h)=>{var p;try{const D=Oe(h),M=it(D);te.set(M,(te.get(M)||0)+d),g.has(M)||g.set(M,new Set),(p=g.get(M))==null||p.add(h)}catch(D){console.error(`Error processing date: ${h}`,D)}}),te.forEach((d,h)=>{var D;const p=((D=g.get(h))==null?void 0:D.size)||0;ne.set(h,{totalTime:d,averageTime:p>0?d/p:0,daysPresent:p})});let S=0;y.forEach(d=>{S+=d});let j=0;_.forEach(d=>{j+=d});let Q=0;return t.forEach(d=>{Q+=d}),{daily:J,weekly:Z,monthly:ne,weekday:{totalTime:S,averageTime:y.size>0?S/y.size:0,daysPresent:y.size},weekend:{totalTime:j,averageTime:_.size>0?j/_.size:0,daysPresent:_.size},total:{totalTime:Q,averageTime:t.size>0?Q/t.size:0,daysPresent:t.size}}},Da=a=>{const e=["日付","総滞在時間(分)","平均滞在時間(分/日)","出席日数"],s=[];return a.forEach((t,n)=>{s.push([n,t.totalTime.toString(),t.averageTime.toFixed(1),t.daysPresent.toString()])}),s.sort((t,n)=>t[0].localeCompare(n[0])),[e.join(","),...s.map(t=>t.join(","))].join(`
`)},Ma=a=>{const e=["週","総滞在時間(分)","平均滞在時間(分/日)","出席日数"],s=[];return a.forEach((t,n)=>{s.push([n,t.totalTime.toString(),t.averageTime.toFixed(1),t.daysPresent.toString()])}),s.sort((t,n)=>t[0].localeCompare(n[0])),[e.join(","),...s.map(t=>t.join(","))].join(`
`)},ka=a=>{const e=["月","総滞在時間(分)","平均滞在時間(分/日)","出席日数"],s=[];return a.forEach((t,n)=>{s.push([n,t.totalTime.toString(),t.averageTime.toFixed(1),t.daysPresent.toString()])}),s.sort((t,n)=>t[0].localeCompare(n[0])),[e.join(","),...s.map(t=>t.join(","))].join(`
`)},Sa=a=>{const e=["区分","総滞在時間(分)","平均滞在時間(分/日)","出席日数"],s=[["平日",a.weekday.totalTime.toString(),a.weekday.averageTime.toFixed(1),a.weekday.daysPresent.toString()],["休日",a.weekend.totalTime.toString(),a.weekend.averageTime.toFixed(1),a.weekend.daysPresent.toString()],["合計",a.total.totalTime.toString(),a.total.averageTime.toFixed(1),a.total.daysPresent.toString()]];return[e.join(","),...s.map(t=>t.join(","))].join(`
`)},Ta=a=>{const s=new TextEncoder().encode(a),t=new Uint8Array([239,187,191]),n=new Uint8Array(t.length+s.length);return n.set(t),n.set(s,t.length),n},fe=(a,e)=>{if(window.confirm(`日本語Excelで開く場合はOKを押してください（Shift-JIS形式）
他のアプリで開く場合はキャンセルを押してください（UTF-8形式）`)){const t=Ta(a),n=new Blob([t],{type:"text/csv;charset=shift_jis"}),i=URL.createObjectURL(n),m=document.createElement("a");m.setAttribute("href",i),m.setAttribute("download",e),m.style.visibility="hidden",document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(i)}else{const t=new Blob([a],{type:"text/csv;charset=utf-8"}),n=URL.createObjectURL(t),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download",e),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)}},xa=(a,e,s)=>{const t=["日付","滞在時間(分)"],n=new Date(e,s,0).getDate(),i=[];for(let m=1;m<=n;m++){const l=`${e}-${String(s).padStart(2,"0")}-${String(m).padStart(2,"0")}`,k=a.get(l);i.push([l,k?k.totalTime.toString():"0"])}return[t.join(","),...i.map(m=>m.join(","))].join(`
`)};var Ca=x("<option> </option>"),Na=x('<div class="loading svelte-1vm8ecp">読み込み中...</div>'),$a=x('<div class="error svelte-1vm8ecp"> </div>'),Ua=x('<tr><td class="svelte-1vm8ecp"> </td><td class="svelte-1vm8ecp"> </td></tr>'),Ea=x('<div class="stats-section svelte-1vm8ecp"><h4 class="svelte-1vm8ecp">日別統計</h4> <div class="table-container svelte-1vm8ecp"><table class="stats-table svelte-1vm8ecp"><thead><tr><th class="svelte-1vm8ecp">日付</th><th class="svelte-1vm8ecp">滞在時間</th></tr></thead><tbody></tbody></table></div> <button class="export-button svelte-1vm8ecp">日別データをCSVでエクスポート</button> <button class="export-button monthly-daily-export svelte-1vm8ecp"><svg class="icon svelte-1vm8ecp" viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"></path></svg> 月全体の日別データをCSVでエクスポート</button></div>'),Ia=x('<tr><td class="svelte-1vm8ecp"> </td><td class="svelte-1vm8ecp"> </td><td class="svelte-1vm8ecp"> </td><td class="svelte-1vm8ecp"> </td></tr>'),za=x('<div class="stats-section svelte-1vm8ecp"><h4 class="svelte-1vm8ecp">週別統計</h4> <div class="table-container svelte-1vm8ecp"><table class="stats-table svelte-1vm8ecp"><thead><tr><th class="svelte-1vm8ecp">週</th><th class="svelte-1vm8ecp">合計滞在時間</th><th class="svelte-1vm8ecp">出席日数</th><th class="svelte-1vm8ecp">平均滞在時間</th></tr></thead><tbody></tbody></table></div> <button class="export-button svelte-1vm8ecp">週別データをCSVでエクスポート</button></div>'),Pa=x('<tr><td class="svelte-1vm8ecp"> </td><td class="svelte-1vm8ecp"> </td><td class="svelte-1vm8ecp"> </td><td class="svelte-1vm8ecp"> </td></tr>'),ja=x('<div class="stats-section svelte-1vm8ecp"><h4 class="svelte-1vm8ecp">月別統計</h4> <div class="table-container svelte-1vm8ecp"><table class="stats-table svelte-1vm8ecp"><thead><tr><th class="svelte-1vm8ecp">月</th><th class="svelte-1vm8ecp">合計滞在時間</th><th class="svelte-1vm8ecp">出席日数</th><th class="svelte-1vm8ecp">平均滞在時間</th></tr></thead><tbody></tbody></table></div> <button class="export-button svelte-1vm8ecp">月別データをCSVでエクスポート</button></div>'),Ra=x('<div class="stats-container svelte-1vm8ecp"><div class="stats-section svelte-1vm8ecp"><h4 class="svelte-1vm8ecp">集計サマリー</h4> <div class="summary-stats svelte-1vm8ecp"><div class="summary-item svelte-1vm8ecp"><span class="label svelte-1vm8ecp">合計滞在時間</span> <span class="value svelte-1vm8ecp"> </span></div> <div class="summary-item svelte-1vm8ecp"><span class="label svelte-1vm8ecp">平均滞在時間（日）</span> <span class="value svelte-1vm8ecp"> </span></div> <div class="summary-item svelte-1vm8ecp"><span class="label svelte-1vm8ecp">出席日数</span> <span class="value svelte-1vm8ecp"> </span></div></div> <div class="weekday-stats svelte-1vm8ecp"><div class="weekday-item svelte-1vm8ecp"><h5 class="svelte-1vm8ecp">平日</h5> <div class="weekday-data svelte-1vm8ecp"><div class="data-item svelte-1vm8ecp"><span> </span></div> <div class="data-item svelte-1vm8ecp"><span> </span></div> <div class="data-item svelte-1vm8ecp"><span> </span></div></div></div> <div class="weekday-item svelte-1vm8ecp"><h5 class="svelte-1vm8ecp">休日</h5> <div class="weekday-data svelte-1vm8ecp"><div class="data-item svelte-1vm8ecp"><span> </span></div> <div class="data-item svelte-1vm8ecp"><span> </span></div> <div class="data-item svelte-1vm8ecp"><span> </span></div></div></div></div> <button class="export-button svelte-1vm8ecp">サマリーをCSVでエクスポート</button></div> <!> <!> <!></div>'),Fa=x('<div class="empty-stats svelte-1vm8ecp">統計データがありません</div>'),Oa=x('<div class="stats-view svelte-1vm8ecp"><h3 class="svelte-1vm8ecp"><span class="grade-badge"> </span> </h3> <div class="month-selector svelte-1vm8ecp"><label for="month-select" class="svelte-1vm8ecp">表示する月</label> <select id="month-select" class="svelte-1vm8ecp"></select></div> <!></div>');function La(a,e){dt(e,!1);let s=Re(e,"memberId",8),t=Re(e,"memberName",8),n=Re(e,"memberGrade",8),i=ce(G(new Date,"yyyy-MM")),m=[],l=ce(null),k=ce(!0),y=ce("");const _=u=>{if(u===0)return"0分";const f=Math.floor(u/60),b=u%60;return f>0?`${f}時間${b>0?` ${b}分`:""}`:`${b}分`},J=u=>{const f=new Date(u);return G(f,"M月d日(E)",{locale:Ye})},Z=u=>{const[f,b]=u.split("-W");return`${f}年 第${b}週`},ee=u=>{const[f,b]=u.split("-");return`${f}年${b}月`},A=async()=>{const[u,f]=r(i).split("-").map(Number);console.log("選択された月:",r(i),"年:",u,"月:",f);const b=aa(new Date(u,f-1)),E=ta(b);console.log("検索期間:",{startDate:G(b,"yyyy-MM-dd"),endDate:G(E,"yyyy-MM-dd")}),Y(k,!0),Y(y,"");try{m=await Jt(s(),b,E),console.log("取得した記録:",m),console.log("記録数:",m.length),Y(l,wa(m,b,E)),console.log("計算された統計:",r(l))}catch(I){console.error("Failed to load stats:",I),Y(y,"統計データの読み込みに失敗しました"),Y(l,null)}finally{Y(k,!1)}},ne=()=>{if(!r(l))return;const u=ka(r(l).monthly),f=`${t()}_月別統計_${r(i)}.csv`;fe(u,f)},te=()=>{if(!r(l))return;const u=Ma(r(l).weekly),f=`${t()}_週別統計_${r(i)}.csv`;fe(u,f)},g=()=>{if(!r(l))return;const u=Da(r(l).daily),f=`${t()}_日別統計_${r(i)}.csv`;fe(u,f)},S=()=>{if(!r(l))return;const[u,f]=r(i).split("-").map(Number),b=xa(r(l).daily,u,f),E=`${t()}_月全体日別統計_${r(i)}.csv`;fe(b,E)},j=()=>{if(!r(l))return;const u=Sa(r(l)),f=`${t()}_統計サマリー_${r(i)}.csv`;fe(u,f)},Q=Array.from({length:6},(u,f)=>{const b=ga(new Date,f),E=G(b,"yyyy-MM"),I=G(b,"yyyy年M月",{locale:Ye});return{value:E,label:I}});mt(()=>{A()}),Ve(()=>r(i),()=>{r(i)&&A()}),ut(),vt();var d=Oa(),h=c(d),p=c(h),D=c(p,!0);o(p);var M=v(p);o(h);var we=v(h,2),De=v(c(we),2);V(()=>{r(i),pt(()=>{})}),he(De,5,()=>Q,ye,(u,f)=>{var b=Ca(),E={},I=c(b,!0);o(b),V(()=>{E!==(E=r(f).value)&&(b.value=(b.__value=r(f).value)??""),w(I,r(f).label)}),T(u,b)}),o(De),o(we);var bt=v(we,2);{var wt=u=>{var f=Na();T(u,f)},Dt=(u,f)=>{{var b=I=>{var ie=$a(),Me=c(ie,!0);o(ie),V(()=>w(Me,r(y))),T(I,ie)},E=(I,ie)=>{{var Me=oe=>{var ve=Ra(),ke=c(ve),Se=v(c(ke),2),Te=c(Se),We=v(c(Te),2),kt=c(We,!0);o(We),o(Te);var xe=v(Te,2),qe=v(c(xe),2),St=c(qe,!0);o(qe),o(xe);var He=v(xe,2),Be=v(c(He),2),Tt=c(Be);o(Be),o(He),o(Se);var Ce=v(Se,2),Ne=c(Ce),Ge=v(c(Ne),2),$e=c(Ge),Je=c($e),xt=c(Je);o(Je),o($e);var Ue=v($e,2),Ze=c(Ue),Ct=c(Ze);o(Ze),o(Ue);var Qe=v(Ue,2),Xe=c(Qe),Nt=c(Xe);o(Xe),o(Qe),o(Ge),o(Ne);var Ke=v(Ne,2),et=v(c(Ke),2),Ee=c(et),tt=c(Ee),$t=c(tt);o(tt),o(Ee);var Ie=v(Ee,2),at=c(Ie),Ut=c(at);o(at),o(Ie);var st=v(Ie,2),rt=c(st),Et=c(rt);o(rt),o(st),o(et),o(Ke),o(Ce);var It=v(Ce,2);o(ke);var nt=v(ke,2);{var zt=C=>{var N=Ea(),$=v(c(N),2),F=c($),O=v(c(F));he(O,5,()=>Array.from(r(l).daily.entries()).sort((U,K)=>U[0].localeCompare(K[0])),ye,(U,K)=>{let L=()=>r(K)[0],q=()=>r(K)[1];var z=Ua(),ae=c(z),H=c(ae,!0);o(ae);var le=v(ae),B=c(le,!0);o(le),o(z),V((de,se,me)=>{qt(z,1,de,"svelte-1vm8ecp"),w(H,se),w(B,me)},[()=>Wt(_t(new Date(L()))?"weekend":""),()=>J(L()),()=>_(q().totalTime)],_e),T(U,z)}),o(O),o(F),o($);var X=v($,2),W=v(X,2);o(N),ue("click",X,g),ue("click",W,S),T(C,N)};re(nt,C=>{r(l).daily.size>0&&C(zt)})}var ot=v(nt,2);{var Pt=C=>{var N=za(),$=v(c(N),2),F=c($),O=v(c(F));he(O,5,()=>Array.from(r(l).weekly.entries()).sort((W,U)=>W[0].localeCompare(U[0])),ye,(W,U)=>{let K=()=>r(U)[0],L=()=>r(U)[1];var q=Ia(),z=c(q),ae=c(z,!0);o(z);var H=v(z),le=c(H,!0);o(H);var B=v(H),de=c(B);o(B);var se=v(B),me=c(se,!0);o(se),o(q),V((ze,Pe,je)=>{w(ae,ze),w(le,Pe),w(de,`${L().daysPresent??""}日`),w(me,je)},[()=>Z(K()),()=>_(L().totalTime),()=>_(L().averageTime)],_e),T(W,q)}),o(O),o(F),o($);var X=v($,2);o(N),ue("click",X,te),T(C,N)};re(ot,C=>{r(l).weekly.size>0&&C(Pt)})}var jt=v(ot,2);{var Rt=C=>{var N=ja(),$=v(c(N),2),F=c($),O=v(c(F));he(O,5,()=>Array.from(r(l).monthly.entries()).sort((W,U)=>W[0].localeCompare(U[0])),ye,(W,U)=>{let K=()=>r(U)[0],L=()=>r(U)[1];var q=Pa(),z=c(q),ae=c(z,!0);o(z);var H=v(z),le=c(H,!0);o(H);var B=v(H),de=c(B);o(B);var se=v(B),me=c(se,!0);o(se),o(q),V((ze,Pe,je)=>{w(ae,ze),w(le,Pe),w(de,`${L().daysPresent??""}日`),w(me,je)},[()=>ee(K()),()=>_(L().totalTime),()=>_(L().averageTime)],_e),T(W,q)}),o(O),o(F),o($);var X=v($,2);o(N),ue("click",X,ne),T(C,N)};re(jt,C=>{r(l).monthly.size>0&&C(Rt)})}o(ve),V((C,N,$,F,O,X)=>{w(kt,C),w(St,N),w(Tt,`${r(l).total.daysPresent??""}日`),w(xt,`合計: ${$??""}`),w(Ct,`平均: ${F??""}`),w(Nt,`日数: ${r(l).weekday.daysPresent??""}日`),w($t,`合計: ${O??""}`),w(Ut,`平均: ${X??""}`),w(Et,`日数: ${r(l).weekend.daysPresent??""}日`)},[()=>_(r(l).total.totalTime),()=>_(r(l).total.averageTime),()=>_(r(l).weekday.totalTime),()=>_(r(l).weekday.averageTime),()=>_(r(l).weekend.totalTime),()=>_(r(l).weekend.averageTime)],_e),ue("click",It,j),T(oe,ve)},Mt=oe=>{var ve=Fa();T(oe,ve)};re(I,oe=>{r(l)?oe(Me):oe(Mt,!1)},ie)}};re(u,I=>{r(y)?I(b):I(E,!1)},f)}};re(bt,u=>{r(k)?u(wt):u(Dt,!1)})}o(d),V(()=>{At(p,`background-color: ${Ht[n()]??""}`),w(D,n()),w(M,` ${t()??""}の統計`)}),ht(De,()=>r(i),u=>Y(i,u)),T(a,d),ft()}var Va=x("<option> </option>"),Ya=x('<div class="select-prompt svelte-6lqgsp">統計を表示するメンバーを選択してください</div>'),Aa=x('<div class="stats-page svelte-6lqgsp"><header class="header svelte-6lqgsp"><h1 class="svelte-6lqgsp">統計</h1> <div class="header-links svelte-6lqgsp"><a href="/" class="back-link svelte-6lqgsp">トップに戻る</a> <a href="/admin" class="back-link svelte-6lqgsp">管理画面に戻る</a></div></header> <div class="member-selector svelte-6lqgsp"><label for="member-select" class="svelte-6lqgsp">メンバーを選択</label> <select id="member-select" class="svelte-6lqgsp"><option>メンバーを選択...</option><!></select></div> <!></div>');function ts(a,e){dt(e,!1);const[s,t]=Vt(),n=()=>Yt(Gt,"$sortedMembers",s),i=ce();let m,l=ce("");mt(()=>{m=Bt();const S=new URLSearchParams(window.location.search).get("member");S&&Y(l,S)}),Ot(()=>{m&&m()});const k=()=>{const g=new URL(window.location.href);r(l)?g.searchParams.set("member",r(l)):g.searchParams.delete("member"),window.history.replaceState({},"",g)};Ve(()=>(n(),r(l)),()=>{Y(i,n().find(g=>g.id===r(l)))}),Ve(()=>r(l),()=>{r(l)&&k()}),ut(),vt();var y=Aa();Ft(g=>{Lt.title="統計 | 滞在管理システム"});var _=v(c(y),2),J=v(c(_),2);V(()=>{r(l),pt(()=>{n()})});var Z=c(J);Z.value=Z.__value="";var ee=v(Z);he(ee,1,n,ye,(g,S)=>{var j=Va(),Q={},d=c(j);o(j),V(()=>{Q!==(Q=r(S).id)&&(j.value=(j.__value=r(S).id)??""),w(d,`[${r(S).grade??""}] ${r(S).name??""}`)}),T(g,j)}),o(J),o(_);var A=v(_,2);{var ne=g=>{La(g,{get memberId(){return r(l)},get memberName(){return r(i).name},get memberGrade(){return r(i).grade}})},te=g=>{var S=Ya();T(g,S)};re(A,g=>{r(l)&&r(i)?g(ne):g(te,!1)})}o(y),ht(J,()=>r(l),g=>Y(l,g)),T(a,y),ft(),t()}export{ts as component};
